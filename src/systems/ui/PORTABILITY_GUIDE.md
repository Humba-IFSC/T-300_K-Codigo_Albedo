# üì¶ Guia de Portabilidade - Mobile Controls

## Como Levar para Outro Projeto

Este guia mostra **passo a passo** como levar o sistema Mobile Controls para qualquer outro projeto Phaser 3.

---

## üéØ Op√ß√£o 1: Instala√ß√£o M√≠nima (1 arquivo)

### Arquivos Necess√°rios
- ‚úÖ `MobileControls.js` (arquivo principal - **OBRIGAT√ìRIO**)

### Passos

1. **Copie o arquivo**
   ```
   Seu projeto/
   ‚îî‚îÄ‚îÄ src/
       ‚îî‚îÄ‚îÄ systems/
           ‚îî‚îÄ‚îÄ MobileControls.js  ‚Üê Copie este arquivo
   ```

2. **Importe na sua cena**
   ```javascript
   import { MobileControls } from './systems/MobileControls.js';
   ```

3. **Use na sua cena**
   ```javascript
   class GameScene extends Phaser.Scene {
       create() {
           // Criar controles
           this.mobileControls = new MobileControls(this);
       }
       
       update() {
           // Usar joystick
           if (this.mobileControls.joystick?.isActive()) {
               const dir = this.mobileControls.joystick.getDirection();
               const force = this.mobileControls.joystick.getForce();
               this.player.setVelocity(dir.x * 200 * force, dir.y * 200 * force);
           }
           
           // Usar bot√µes
           if (this.mobileControls.isButtonPressed('interact')) {
               this.interact();
           }
       }
   }
   ```

4. **Pronto! ‚úÖ**

---

## üöÄ Op√ß√£o 2: Instala√ß√£o Completa (com configura√ß√µes e exemplos)

### Arquivos Recomendados
- ‚úÖ `MobileControls.js` (principal - **OBRIGAT√ìRIO**)
- ‚úÖ `MobileControlsConfigs.js` (configura√ß√µes pr√©-definidas - **RECOMENDADO**)
- üìÑ `MOBILE_CONTROLS_README.md` (documenta√ß√£o - opcional)
- üìÑ `MobileControlsExamples.js` (exemplos - opcional)
- üìÑ `MIGRATION_GUIDE.md` (guia de migra√ß√£o - opcional)

### Estrutura Recomendada
```
Seu projeto/
‚îî‚îÄ‚îÄ src/
    ‚îî‚îÄ‚îÄ systems/
        ‚îî‚îÄ‚îÄ ui/
            ‚îú‚îÄ‚îÄ MobileControls.js           ‚Üê Principal
            ‚îú‚îÄ‚îÄ MobileControlsConfigs.js    ‚Üê Configura√ß√µes prontas
            ‚îú‚îÄ‚îÄ MOBILE_CONTROLS_README.md   ‚Üê Documenta√ß√£o
            ‚îú‚îÄ‚îÄ MobileControlsExamples.js   ‚Üê Exemplos
            ‚îî‚îÄ‚îÄ MIGRATION_GUIDE.md          ‚Üê Guia de migra√ß√£o
```

### Uso com Configura√ß√µes Pr√©-definidas
```javascript
import { MobileControls } from './systems/ui/MobileControls.js';
import { CONFIGS } from './systems/ui/MobileControlsConfigs.js';

class GameScene extends Phaser.Scene {
    create() {
        // Use uma configura√ß√£o pronta!
        this.mobileControls = new MobileControls(this, CONFIGS.TOP_DOWN_RPG);
    }
}
```

---

## üìã Checklist de Portabilidade

Use esta checklist ao portar para outro projeto:

### Antes de Come√ßar
- [ ] Backup do projeto atual
- [ ] Verifique vers√£o do Phaser (requer 3.x)
- [ ] Prepare estrutura de pastas

### Copiar Arquivos
- [ ] Copiar `MobileControls.js`
- [ ] Copiar `MobileControlsConfigs.js` (opcional)
- [ ] Copiar documenta√ß√£o (opcional)

### Integra√ß√£o
- [ ] Importar nas cenas necess√°rias
- [ ] Adicionar c√≥digo de inicializa√ß√£o
- [ ] Adicionar c√≥digo de uso no update
- [ ] Configurar bot√µes conforme necess√°rio

### Testes
- [ ] Testar joystick em todas as dire√ß√µes
- [ ] Testar todos os bot√µes
- [ ] Testar em dispositivo m√≥vel real
- [ ] Testar detec√ß√£o autom√°tica de mobile
- [ ] Testar habilitar/desabilitar controles
- [ ] Testar mostrar/esconder controles

---

## üîß Configura√ß√£o para Diferentes Tipos de Jogos

### Top-Down RPG (Zelda-like)
```javascript
import { MobileControls } from './systems/MobileControls.js';

this.mobileControls = new MobileControls(this, {
    joystick: { enabled: true },
    buttons: [
        { action: 'interact', label: 'A', color: 0x00FF00 },
        { action: 'run', label: 'B', color: 0xFF0000 },
        { action: 'menu', label: 'X', color: 0x0000FF }
    ]
});
```

### Plataforma (Mario-like)
```javascript
import { MobileControls } from './systems/MobileControls.js';

this.mobileControls = new MobileControls(this, {
    joystick: { enabled: false },  // Sem joystick
    buttons: [
        { action: 'left', label: '‚óÑ', color: 0x888888 },
        { action: 'right', label: '‚ñ∫', color: 0x888888 },
        { action: 'jump', label: 'A', color: 0x00FF00 }
    ]
});
```

### Beat 'em Up (Streets of Rage-like)
```javascript
import { MobileControls } from './systems/MobileControls.js';

this.mobileControls = new MobileControls(this, {
    joystick: { enabled: true },
    buttons: [
        { action: 'attack', label: 'A', color: 0xFF0000 },
        { action: 'jump', label: 'B', color: 0x00FF00 },
        { action: 'special', label: 'X', color: 0xFFFF00 }
    ]
});
```

---

## üí° Adapta√ß√µes Comuns

### Adaptar para Sistema de Anima√ß√µes Diferente

Se seu jogo usa nomes de anima√ß√µes diferentes:

```javascript
update() {
    if (this.mobileControls.joystick?.isActive()) {
        const dir = this.mobileControls.joystick.getDirection();
        const force = this.mobileControls.joystick.getForce();
        
        // Adapte para seus nomes de anima√ß√£o
        if (Math.abs(dir.x) > Math.abs(dir.y)) {
            if (dir.x > 0) {
                this.player.anims.play('moveRight', true);  // Seu nome
            } else {
                this.player.anims.play('moveLeft', true);   // Seu nome
            }
        } else {
            if (dir.y > 0) {
                this.player.anims.play('moveDown', true);   // Seu nome
            } else {
                this.player.anims.play('moveUp', true);     // Seu nome
            }
        }
        
        this.player.setVelocity(dir.x * 200 * force, dir.y * 200 * force);
    }
}
```

### Adaptar para Sistema de F√≠sica Diferente

Se voc√™ usa Matter.js em vez de Arcade:

```javascript
update() {
    if (this.mobileControls.joystick?.isActive()) {
        const dir = this.mobileControls.joystick.getDirection();
        const force = this.mobileControls.joystick.getForce();
        const speed = 0.01;  // Ajuste conforme necess√°rio
        
        // Para Matter.js
        this.matter.applyForce(
            this.player,
            { x: dir.x * speed * force, y: dir.y * speed * force }
        );
    }
}
```

### Adaptar Posi√ß√µes dos Bot√µes

Se a tela do seu jogo tem propor√ß√µes diferentes:

```javascript
this.mobileControls = new MobileControls(this, {
    buttons: [
        {
            action: 'interact',
            label: 'A',
            color: 0x00FF00,
            position: 'right-bottom'  // Posi√ß√µes pr√©-definidas
        }
    ],
    buttonRadius: 50,  // Ajuste o tamanho
    buttonSpacing: 20  // Ajuste o espa√ßamento
});
```

---

## üé® Personaliza√ß√£o Visual

### Usar Sprites Pr√≥prios

1. **Carregue seus sprites no preload:**
   ```javascript
   preload() {
       this.load.image('myButtonA', 'assets/ui/button_a.png');
       this.load.image('myButtonB', 'assets/ui/button_b.png');
   }
   ```

2. **Configure para usar os sprites:**
   ```javascript
   create() {
       this.mobileControls = new MobileControls(this, {
           buttons: [
               {
                   action: 'interact',
                   label: 'A',
                   sprite: 'myButtonA',  // Usa seu sprite
                   position: 'right-bottom'
               },
               {
                   action: 'run',
                   label: 'B',
                   sprite: 'myButtonB',  // Usa seu sprite
                   position: 'left-top'
               }
           ]
       });
   }
   ```

### Customizar Cores

```javascript
this.mobileControls = new MobileControls(this, {
    buttons: [
        { action: 'interact', label: 'A', color: 0x00FF00 },  // Verde
        { action: 'run', label: 'B', color: 0xFF0000 },       // Vermelho
        { action: 'jump', label: 'X', color: 0x0000FF }       // Azul
    ],
    buttonAlpha: 0.9  // Mais opaco
});
```

---

## üêõ Resolu√ß√£o de Problemas

### Problema: Controles n√£o aparecem

**Causa:** S√≥ aparece em dispositivos m√≥veis por padr√£o.

**Solu√ß√£o:** Force mostrar para testar:
```javascript
this.mobileControls = new MobileControls(this, {
    alwaysShow: true  // Mostra sempre
});
```

### Problema: Joystick responde mas player n√£o se move

**Causa:** C√≥digo de movimento n√£o est√° correto.

**Solu√ß√£o:** Verifique se est√° aplicando velocidade:
```javascript
update() {
    if (this.mobileControls.joystick?.isActive()) {
        const dir = this.mobileControls.joystick.getDirection();
        const force = this.mobileControls.joystick.getForce();
        
        // IMPORTANTE: Aplicar velocidade
        this.player.setVelocity(
            dir.x * 200 * force,
            dir.y * 200 * force
        );
    } else {
        // IMPORTANTE: Parar quando n√£o usar joystick
        this.player.setVelocity(0, 0);
    }
}
```

### Problema: Bot√µes n√£o respondem

**Causa:** M√©todo errado ou bot√£o desabilitado.

**Solu√ß√£o:** Use o m√©todo correto:
```javascript
// CORRETO
if (this.mobileControls.isButtonPressed('interact')) {
    // ...
}

// ERRADO
if (this.mobileControls.buttons.isButtonDown('interact')) {
    // ...
}
```

### Problema: Conflito com controles de teclado

**Causa:** Ambos est√£o ativos ao mesmo tempo.

**Solu√ß√£o:** Priorize o joystick:
```javascript
update() {
    // Prioriza joystick
    if (this.mobileControls.joystick?.isActive()) {
        // Usa joystick
        const dir = this.mobileControls.joystick.getDirection();
        // ...
        return;  // IMPORTANTE: return para n√£o usar teclado
    }
    
    // S√≥ usa teclado se joystick n√£o est√° ativo
    if (this.cursors.left.isDown) {
        // ...
    }
}
```

---

## üì± Teste em Dispositivos Reais

### Preparar para Testes

1. **Hospede seu jogo:**
   - Use servidor local com HTTPS (required para touch)
   - Ou use ngrok/localtunnel para expor localhost
   - Ou fa√ßa deploy em servidor web

2. **Acesse no mobile:**
   - Abra no navegador do celular
   - Use modo fullscreen se poss√≠vel
   - Teste em diferentes dispositivos

3. **Debug no mobile:**
   ```javascript
   // Adicione logs para debug
   create() {
       this.mobileControls = new MobileControls(this);
       
       console.log('Mobile Controls criado:', {
           isMobile: this.mobileControls.isMobile,
           hasJoystick: !!this.mobileControls.joystick,
           hasButtons: !!this.mobileControls.buttons
       });
   }
   ```

### Chrome DevTools Mobile

Para testar no desktop:

1. Abra DevTools (F12)
2. Ctrl+Shift+M (Toggle Device Toolbar)
3. Selecione um dispositivo m√≥vel
4. Configure para `alwaysShow: true` durante desenvolvimento

---

## ‚úÖ Exemplo Completo Port√°til

Aqui est√° um exemplo **completo e funcional** que voc√™ pode copiar:

```javascript
// GameScene.js - COPIE ESTE C√ìDIGO
import { MobileControls } from './systems/MobileControls.js';

export class GameScene extends Phaser.Scene {
    constructor() {
        super({ key: 'GameScene' });
    }
    
    create() {
        // 1. Criar controles m√≥veis
        this.mobileControls = new MobileControls(this, {
            joystick: {
                enabled: true,
                deadZone: 0.2
            },
            buttons: [
                { action: 'interact', label: 'A', color: 0x00FF00, position: 'right-bottom' },
                { action: 'run', label: 'B', color: 0xFF0000, position: 'left-top' }
            ],
            alwaysShow: false  // Mude para true para testar em desktop
        });
        
        // 2. Criar player
        this.player = this.physics.add.sprite(400, 300, 'player');
        this.player.setCollideWorldBounds(true);
        
        // 3. Velocidades
        this.walkSpeed = 150;
        this.runSpeed = 260;
    }
    
    update() {
        // 4. Controle de movimento
        const joystick = this.mobileControls.joystick;
        
        if (joystick && joystick.isActive()) {
            // Joystick est√° ativo
            const dir = joystick.getDirection();
            const force = joystick.getForce();
            const isRunning = this.mobileControls.isButtonPressed('run');
            const speed = isRunning ? this.runSpeed : this.walkSpeed;
            
            // Aplica movimento
            this.player.setVelocity(dir.x * speed * force, dir.y * speed * force);
            
            // Anima√ß√µes (adapte para seus nomes)
            if (Math.abs(dir.x) > Math.abs(dir.y)) {
                this.player.anims.play(dir.x > 0 ? 'walk-right' : 'walk-left', true);
            } else {
                this.player.anims.play(dir.y > 0 ? 'walk-down' : 'walk-up', true);
            }
        } else {
            // Para o player
            this.player.setVelocity(0, 0);
            this.player.anims.stop();
        }
        
        // 5. A√ß√µes
        if (this.mobileControls.isButtonPressed('interact')) {
            this.interact();
        }
    }
    
    interact() {
        console.log('Interagindo!');
        // Sua l√≥gica aqui
    }
}
```

---

## üéØ Resumo R√°pido

1. **Copie** `MobileControls.js` para seu projeto
2. **Importe** na sua cena
3. **Crie** no `create()`: `this.mobileControls = new MobileControls(this)`
4. **Use** no `update()`: Verificar joystick e bot√µes
5. **Teste** em mobile ou com `alwaysShow: true`

**Pronto! Seu jogo agora tem controles m√≥veis funcionais! üéÆüì±**

---

## üìö Links √öteis

- `MOBILE_CONTROLS_README.md` - Documenta√ß√£o completa
- `MobileControlsExamples.js` - Mais exemplos
- `MobileControlsConfigs.js` - Configura√ß√µes pr√©-definidas
- `MIGRATION_GUIDE.md` - Migrar de sistema antigo

---

**D√∫vidas? Consulte a documenta√ß√£o completa!**
